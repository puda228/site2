<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Manager Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 16px;
            color: var(--tg-theme-text-color, #000);
            background: var(--tg-theme-bg-color, #fff);
        }

        .task-card {
            background: var(--tg-theme-secondary-bg-color, #f0f0f0);
            border-radius: 10px;
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .task-card:hover {
            transform: translateY(-2px);
        }

        .task-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .task-description {
            font-size: 14px;
            color: var(--tg-theme-hint-color, #666);
        }

        .task-points {
            font-size: 16px;
            color: var(--tg-theme-accent-text-color, #2481cc);
            margin-top: 8px;
        }

        .button {
            background: var(--tg-theme-button-color, #2481cc);
            color: var(--tg-theme-button-text-color, #fff);
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            margin-top: 8px;
        }

        .completed {
            opacity: 0.7;
        }

        .completed::after {
            content: "‚úì";
            color: #4CAF50;
            margin-left: 8px;
        }

        #user-stats {
            background: var(--tg-theme-secondary-bg-color, #f0f0f0);
            border-radius: 10px;
            padding: 16px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div id="user-stats">
        <h2>–í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å</h2>
        <p>–û—á–∫–∏: <span id="points">0</span> üèÖ</p>
        <p>–í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–¥–∞–Ω–∏–π: <span id="completed-tasks">0</span></p>
    </div>

    <div id="tasks-container">
        <!-- –ó–∞–¥–∞–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        tg.ready();

        // –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–¥–∞–Ω–∏–π
        const tasks = [
            {
                id: 1,
                title: "–ü–µ—Ä–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ",
                description: "–ü–æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è",
                points: 5,
                completed: false
            },
            {
                id: 2,
                title: "–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞",
                description: "–†–µ—à–∏—Ç–µ –ø—Ä–∏–º–µ—Ä: 2 + 2 * 2",
                points: 10,
                completed: false
            },
            {
                id: 3,
                title: "–ó–∞–≥–∞–¥–∫–∞",
                description: "–ß—Ç–æ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —Å –∑–∞–∫—Ä—ã—Ç—ã–º–∏ –≥–ª–∞–∑–∞–º–∏?",
                points: 15,
                completed: false
            }
        ];

        let userPoints = 0;
        let completedTasksCount = 0;

        function renderTasks() {
            const container = document.getElementById('tasks-container');
            container.innerHTML = '';

            tasks.forEach(task => {
                const taskElement = document.createElement('div');
                taskElement.className = `task-card ${task.completed ? 'completed' : ''}`;
                
                taskElement.innerHTML = `
                    <div class="task-title">${task.title}</div>
                    <div class="task-description">${task.description}</div>
                    <div class="task-points">üèÖ ${task.points} –æ—á–∫–æ–≤</div>
                    ${!task.completed ? `<button class="button" onclick="completeTask(${task.id})">–í—ã–ø–æ–ª–Ω–∏—Ç—å</button>` : ''}
                `;

                container.appendChild(taskElement);
            });

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            document.getElementById('points').textContent = userPoints;
            document.getElementById('completed-tasks').textContent = completedTasksCount;
        }

        function completeTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (task && !task.completed) {
                task.completed = true;
                userPoints += task.points;
                completedTasksCount++;
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Telegram
                tg.sendData(JSON.stringify({
                    action: 'complete_task',
                    taskId: taskId,
                    points: task.points
                }));

                renderTasks();
            }
        }

        // –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä –∑–∞–¥–∞–Ω–∏–π
        renderTasks();

        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –≥–ª–∞–≤–Ω—É—é –∫–Ω–æ–ø–∫—É Telegram
        tg.MainButton.text = "–ó–∞–∫—Ä—ã—Ç—å";
        tg.MainButton.onClick(() => {
            tg.close();
        });
        tg.MainButton.show();
    </script>
</body>
</html>
